#!/bin/tcsh

cmsenv

set SOURCE  = $CMSSW_BASE/src
set SCRIPTS = $CMSSW_BASE/src/Documentation/ReferenceManualScripts/python
set DATA    = $CMSSW_BASE/src/Documentation/ReferenceManualScripts/data
set DOC     = $CMSSW_BASE/doc
set HTML    = $DOC/html

if (-e $DOC) then
    rm -Rf $DOC
endif

mkdir $DOC

sed -e 's|@CMSSW_IN@|'$SOURCE'|g' -e 's|@CMSSW_OUT@|'$DOC'|g' -e 's|@DOXY_PATH@|'$DATA'|g' $DATA/Doxygen.conf > $DATA/Doxygen.conf.tmp

doxygen $DATA/Doxygen.conf.tmp

rm $DATA/Doxygen.conf.tmp

cp -r $DATA/iframes $HTML/

cp $HTML/index.html $HTML/index.html.original
python $SCRIPTS/MainPageGenerator.py $HTML/index.html $DATA $CMSSW_VERSION

cp $HTML/annotated.html $HTML/annotated.html.original
python $SCRIPTS/TableParser.py $HTML/annotated.html
cp $HTML/annotatedList_A.html $HTML/annotated.html

cp $HTML/namespaces.html $HTML/namespaces.html.original
python $SCRIPTS/TableParser.py $HTML/namespaces.html
cp $HTML/namespacesList_A.html $HTML/namespaces.html

cp $HTML/pages.html $HTML/pages.html.original
python $SCRIPTS/TableParser.py $HTML/pages.html
cp $HTML/pagesList_A.html $HTML/pages.html

cp $HTML/namespaces.html.original $HTML/configfiles.html
python $SCRIPTS/TableParser.py $HTML/configfiles.html
cp $HTML/configfilesList_A.html $HTML/configfiles.html
